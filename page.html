<!DOCTYPE html>
<html lang="th" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏ó‡∏£‡∏î</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        dark: {
                            100: '#f3f4f6',
                            200: '#e5e7eb',
                            300: '#d1d5db',
                            400: '#9ca3af',
                            500: '#6b7280',
                            600: '#4b5563',
                            700: '#374151',
                            800: '#1f2937',
                            900: '#111827',
                        }
                    }
                }
            }
        }
    </script>
    <style>
        /* Custom scrollbar for dark mode */
        .dark ::-webkit-scrollbar {
            width: 12px;
            height: 12px;
        }
        .dark ::-webkit-scrollbar-track {
            background: #374151;
        }
        .dark ::-webkit-scrollbar-thumb {
            background-color: #4b5563;
            border-radius: 6px;
            border: 3px solid #374151;
        }
        .dark ::-webkit-scrollbar-thumb:hover {
            background-color: #6b7280;
        }

        /* Custom scrollbar for light mode */
        ::-webkit-scrollbar {
            width: 12px;
            height: 12px;
        }
        ::-webkit-scrollbar-track {
            background: #f3f4f6;
        }
        ::-webkit-scrollbar-thumb {
            background-color: #d1d5db;
            border-radius: 6px;
            border: 3px solid #f3f4f6;
        }
        ::-webkit-scrollbar-thumb:hover {
            background-color: #9ca3af;
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-dark-900 min-h-screen text-gray-800 dark:text-gray-200">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <div class="flex justify-between items-center mb-6">
            <h1 class="text-2xl font-bold">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏ó‡∏£‡∏î</h1>
            <button id="darkModeToggle" class="px-4 py-2 rounded-lg bg-gray-200 dark:bg-dark-700 hover:bg-gray-300 dark:hover:bg-dark-600 transition-colors duration-200">
                <span class="dark:hidden">üåô Dark Mode</span>
                <span class="hidden dark:inline">‚òÄÔ∏è Light Mode</span>
            </button>
        </div>

        <!-- Filters -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
            <div>
                <label class="block text-sm font-medium mb-2">‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏° Symbol:</label>
                <select id="symbolFilter" class="w-full p-2 rounded-lg border border-gray-300 dark:border-dark-600 bg-gray-50 dark:bg-dark-700 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200">
                    <option value="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                </select>
            </div>
            <div>
                <label class="block text-sm font-medium mb-2">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô:</label>
                <input type="date" id="startDate" class="w-full p-2 rounded-lg border border-gray-300 dark:border-dark-600 bg-gray-50 dark:bg-dark-700 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200">
            </div>
            <div>
                <label class="block text-sm font-medium mb-2">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î:</label>
                <input type="date" id="endDate" class="w-full p-2 rounded-lg border border-gray-300 dark:border-dark-600 bg-gray-50 dark:bg-dark-700 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200">
            </div>
            <div class="flex items-end">
                <button id="applyFilter" class="w-full p-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors duration-200 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">
                    ‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                </button>
            </div>
        </div>

        <!-- Summary and Chart -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
            <!-- Summary -->
            <div class="bg-white dark:bg-dark-800 rounded-lg shadow-lg p-4">
                <h2 class="text-xl font-bold mb-4">‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏ó‡∏£‡∏î</h2>
                <ul class="space-y-2">
                    <li class="p-3 bg-gray-50 dark:bg-dark-700 rounded transition-colors duration-200">
                        <span class="block text-sm text-gray-600 dark:text-gray-400 mb-1">‡∏Å‡∏≥‡πÑ‡∏£/‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</span>
                        <span id="daily-profit" class="font-mono text-lg"></span>
                    </li>
                    <li class="p-3 bg-gray-50 dark:bg-dark-700 rounded transition-colors duration-200">
                        <span class="block text-sm text-gray-600 dark:text-gray-400 mb-1">‡∏Å‡∏≥‡πÑ‡∏£/‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô‡∏£‡∏≤‡∏¢‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå</span>
                        <span id="weekly-profit" class="font-mono text-lg"></span>
                    </li>
                    <li class="p-3 bg-gray-50 dark:bg-dark-700 rounded transition-colors duration-200">
                        <span class="block text-sm text-gray-600 dark:text-gray-400 mb-1">‡∏Å‡∏≥‡πÑ‡∏£/‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</span>
                        <span id="monthly-profit" class="font-mono text-lg"></span>
                    </li>
                    <li class="p-3 bg-gray-50 dark:bg-dark-700 rounded transition-colors duration-200">
                        <span class="block text-sm text-gray-600 dark:text-gray-400 mb-1">‡∏Å‡∏≥‡πÑ‡∏£/‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</span>
                        <span id="total-profit" class="font-mono text-lg"></span>
                    </li>
                </ul>
            </div>

            <!-- Chart -->
            <div class="md:col-span-3 bg-white dark:bg-dark-800 rounded-lg shadow-lg p-4">
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 space-y-2 sm:space-y-0">
                    <h2 class="text-xl font-bold">‡∏Å‡∏£‡∏≤‡∏ü‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∞‡∏™‡∏°</h2>
                    <div class="flex gap-4">
                        <label class="inline-flex items-center">
                            <input type="radio" name="chartType" value="date" checked
                                   class="form-radio text-blue-500 focus:ring-blue-500 dark:bg-dark-700">
                            <span class="ml-2">‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏≤‡∏°‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</span>
                        </label>
                        <label class="inline-flex items-center">
                            <input type="radio" name="chartType" value="trade"
                                   class="form-radio text-blue-500 focus:ring-blue-500 dark:bg-dark-700">
                            <span class="ml-2">‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏≤‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏ó‡∏£‡∏î</span>
                        </label>
                    </div>
                </div>
                <div class="relative h-[400px]">
                    <canvas id="cumulativeProfitChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Trade Records Table -->
        <div class="bg-white dark:bg-dark-800 rounded-lg shadow-lg p-4">
            <h2 class="text-xl font-bold mb-4">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏ó‡∏£‡∏î‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h2>
            <div class="overflow-x-auto">
                <table class="w-full">
                    <thead class="bg-gray-50 dark:bg-dark-700">
                        <tr>
                            <th class="p-3 text-left font-semibold">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                            <th class="p-3 text-left font-semibold">‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå</th>
                            <th class="p-3 text-left font-semibold">‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥</th>
                            <th class="p-3 text-right font-semibold">‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤</th>
                            <th class="p-3 text-right font-semibold">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏≠‡∏≠‡∏Å</th>
                            <th class="p-3 text-right font-semibold">‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì</th>
                            <th class="p-3 text-right font-semibold">‡∏Å‡∏≥‡πÑ‡∏£/‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô</th>
                            <th class="p-3 text-right font-semibold">‡∏Å‡∏≥‡πÑ‡∏£/‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô %</th>
                            <th class="p-3 text-left font-semibold">‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•</th>
                        </tr>
                    </thead>
                    <tbody id="trade-records">
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        let allTrades = [];
        let cumulativeProfitChart;
    
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏±‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç
        function formatNumber(number, decimals = 2) {
            return new Intl.NumberFormat('th-TH', {
                minimumFractionDigits: decimals,
                maximumFractionDigits: decimals
            }).format(number);
        }
    
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡∏ï‡∏≤‡∏£‡∏≤‡∏á
        function updateTable(trades) {
            let tableContent = '';
            trades.slice(0, 10).forEach(function(trade) {
                const isProfitPositive = trade.profit_loss >= 0;
                const profitLossClass = isProfitPositive ? 'text-green-500' : 'text-red-500';
                
                tableContent += `
                    <tr class="border-b border-gray-200 dark:border-dark-600 hover:bg-gray-50 dark:hover:bg-dark-700 transition-colors duration-200">
                        <td class="p-3 font-mono text-sm">${new Date(trade.timestamp).toLocaleString('th-TH')}</td>
                        <td class="p-3 font-semibold">${trade.symbol}</td>
                        <td class="p-3">${trade.action}</td>
                        <td class="p-3 text-right font-mono">${formatNumber(trade.entry_price, 4)}</td>
                        <td class="p-3 text-right font-mono">${formatNumber(trade.exit_price, 4)}</td>
                        <td class="p-3 text-right font-mono">${formatNumber(trade.amount, 6)}</td>
                        <td class="p-3 text-right font-mono ${profitLossClass}">
                            ${formatNumber(trade.profit_loss)}
                        </td>
                        <td class="p-3 text-right font-mono ${profitLossClass}">
                            ${formatNumber(trade.profit_loss_percentage)}%
                        </td>
                        <td class="p-3 text-sm">${trade.reason}</td>
                    </tr>`;
            });
            
            if (trades.length === 0) {
                tableContent = `
                    <tr>
                        <td colspan="9" class="p-4 text-center text-gray-500 dark:text-gray-400">
                            ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏ó‡∏£‡∏î
                        </td>
                    </tr>`;
            }
            
            $('#trade-records').html(tableContent);
        }
    
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏™‡∏£‡∏∏‡∏õ
        function calculateSummary(trades) {
            const now = new Date();
            let daily_profit = 0;
            let weekly_profit = 0;
            let monthly_profit = 0;
            let total_profit = 0;
    
            trades.forEach(trade => {
                const tradeDate = new Date(trade.timestamp);
                const daysDiff = (now - tradeDate) / (1000 * 60 * 60 * 24);
    
                total_profit += trade.profit_loss;
                if (daysDiff <= 1) daily_profit += trade.profit_loss;
                if (daysDiff <= 7) weekly_profit += trade.profit_loss;
                if (daysDiff <= 30) monthly_profit += trade.profit_loss;
            });
    
            return { daily_profit, weekly_profit, monthly_profit, total_profit };
        }
    
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡∏™‡∏£‡∏∏‡∏õ
        function updateSummary(summary) {
            function getColorClass(value) {
                return value >= 0 ? 'text-green-500' : 'text-red-500';
            }
    
            $('#daily-profit').text(formatNumber(summary.daily_profit))
                            .removeClass('text-green-500 text-red-500')
                            .addClass(getColorClass(summary.daily_profit));
                            
            $('#weekly-profit').text(formatNumber(summary.weekly_profit))
                            .removeClass('text-green-500 text-red-500')
                            .addClass(getColorClass(summary.weekly_profit));
                            
            $('#monthly-profit').text(formatNumber(summary.monthly_profit))
                            .removeClass('text-green-500 text-red-500')
                            .addClass(getColorClass(summary.monthly_profit));
    
            $('#total-profit').text(formatNumber(summary.total_profit))
                            .removeClass('text-green-500 text-red-500')
                            .addClass(getColorClass(summary.total_profit));
        }
    
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏µ‡πÅ‡∏ö‡∏ö‡∏™‡∏∏‡πà‡∏°
        function getRandomColor() {
            const colors = [
                '#2563eb', '#7c3aed', '#db2777', '#dc2626', '#ea580c',
                '#65a30d', '#0d9488', '#0284c7', '#6366f1', '#9333ea'
            ];
            return colors[Math.floor(Math.random() * colors.length)];
        }
    
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡∏Å‡∏£‡∏≤‡∏ü
        function updateCumulativeProfitChart(trades) {
            const isDark = document.documentElement.classList.contains('dark');
            const chartType = $('input[name="chartType"]:checked').val();
            const symbols = [...new Set(trades.map(trade => trade.symbol))];
            
            const datasets = symbols.map(symbol => {
                const symbolTrades = trades.filter(trade => trade.symbol === symbol)
                    .sort((a, b) => new Date(a.timestamp) - new Date(b.timestamp));
                
                let cumulativeProfit = 0;
                const data = symbolTrades.map((trade, index) => {
                    cumulativeProfit += trade.profit_loss;
                    return {
                        x: chartType === 'date' ? new Date(trade.timestamp) : index + 1,
                        y: cumulativeProfit
                    };
                });
    
                return {
                    label: symbol,
                    data: data,
                    fill: false,
                    borderColor: getRandomColor(),
                    borderWidth: 2,
                    tension: 0.1,
                    pointRadius: 3,
                    pointHoverRadius: 5
                };
            });
    
            const options = {
                responsive: true,
                maintainAspectRatio: false,
                interaction: {
                    mode: 'index',
                    intersect: false,
                },
                scales: {
                    x: {
                        type: chartType === 'date' ? 'time' : 'linear',
                        time: chartType === 'date' ? {
                            unit: 'day',
                            tooltipFormat: 'PPP'
                        } : undefined,
                        grid: {
                            color: isDark ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
                        },
                        ticks: {
                            color: isDark ? '#9ca3af' : '#4b5563'
                        },
                        title: {
                            display: true,
                            text: chartType === 'date' ? '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà' : '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏ó‡∏£‡∏î',
                            color: isDark ? '#9ca3af' : '#4b5563'
                        }
                    },
                    y: {
                        grid: {
                            color: isDark ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
                        },
                        ticks: {
                            color: isDark ? '#9ca3af' : '#4b5563',
                            callback: function(value) {
                                return formatNumber(value);
                            }
                        },
                        title: {
                            display: true,
                            text: '‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∞‡∏™‡∏°',
                            color: isDark ? '#9ca3af' : '#4b5563'
                        }
                    }
                },
                plugins: {
                    legend: {
                        position: 'top',
                        labels: {
                            color: isDark ? '#9ca3af' : '#4b5563',
                            padding: 20,
                            font: {
                                size: 12
                            }
                        }
                    },
                    tooltip: {
                        backgroundColor: isDark ? '#1f2937' : 'white',
                        titleColor: isDark ? '#e5e7eb' : '#1f2937',
                        bodyColor: isDark ? '#e5e7eb' : '#1f2937',
                        borderColor: isDark ? '#374151' : '#e5e7eb',
                        borderWidth: 1,
                        padding: 12,
                        callbacks: {
                            label: function(context) {
                                return `${context.dataset.label}: ${formatNumber(context.parsed.y)}`;
                            }
                        }
                    }
                }
            };
    
            if (cumulativeProfitChart) {
                cumulativeProfitChart.destroy();
            }
    
            cumulativeProfitChart = new Chart(
                document.getElementById('cumulativeProfitChart'),
                {
                    type: 'line',
                    data: { datasets: datasets },
                    options: options
                }
            );
        }
    
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        function filterTrades() {
            const selectedSymbol = $('#symbolFilter').val();
            const startDate = $('#startDate').val() ? new Date($('#startDate').val()) : null;
            const endDate = $('#endDate').val() ? new Date($('#endDate').val()) : null;
    
            let filteredTrades = allTrades;
    
            if (selectedSymbol !== 'all') {
                filteredTrades = filteredTrades.filter(trade => trade.symbol === selectedSymbol);
            }
    
            if (startDate) {
                filteredTrades = filteredTrades.filter(trade => new Date(trade.timestamp) >= startDate);
            }
    
            if (endDate) {
                const adjustedEndDate = new Date(endDate);
                adjustedEndDate.setDate(adjustedEndDate.getDate() + 1);
                filteredTrades = filteredTrades.filter(trade => new Date(trade.timestamp) < adjustedEndDate);
            }
    
            updateTable(filteredTrades);
            const summary = calculateSummary(filteredTrades);
            updateSummary(summary);
            updateCumulativeProfitChart(filteredTrades);
        }
    
        // Event Handlers
        $(document).ready(function() {
            // Dark Mode Toggle
            $('#darkModeToggle').click(function() {
                document.documentElement.classList.toggle('dark');
                localStorage.setItem('darkMode', document.documentElement.classList.contains('dark'));
                if (cumulativeProfitChart) {
                    filterTrades(); // ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏Å‡∏£‡∏≤‡∏ü‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï theme
                }
            });
    
            // Load Dark Mode Preference
            if (localStorage.getItem('darkMode') === 'true') {
                document.documentElement.classList.add('dark');
            }
    
            // Load Trade Data
            async function loadAllTrades() {
                try {
                    // ‡πÇ‡∏´‡∏•‡∏î index.json ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠ symbols
                    const indexResponse = await fetch('json/message_logs/index.json');
                    if (!indexResponse.ok) throw new Error('Cannot load symbols');
                    const symbols = await indexResponse.json();
    
                    // ‡πÇ‡∏´‡∏•‡∏î trades ‡∏à‡∏≤‡∏Å‡πÅ‡∏ï‡πà‡∏•‡∏∞ symbol
                    allTrades = [];
                    for (const symbol of symbols) {
                        try {
                            const response = await fetch(`json/trade_records/${symbol}.json`);
                            if (response.ok) {
                                const trades = await response.json();
                                allTrades = allTrades.concat(trades);
                            }
                        } catch (error) {
                            console.log(`No trades found for ${symbol}`);
                        }
                    }
    
                    // Sort trades by timestamp (newest first)
                    allTrades.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
    
                    // Populate symbol filter
                    const uniqueSymbols = [...new Set(allTrades.map(trade => trade.symbol))];
                    uniqueSymbols.sort().forEach(symbol => {
                        $('#symbolFilter').append(`<option value="${symbol}">${symbol}</option>`);
                    });
    
                    // Set initial date range
                    if (allTrades.length > 0) {
                        const dates = allTrades.map(trade => new Date(trade.timestamp));
                        const earliestDate = new Date(Math.min.apply(null, dates));
                        const latestDate = new Date(Math.max.apply(null, dates));
                        
                        $('#startDate').val(earliestDate.toISOString().split('T')[0]);
                        $('#endDate').val(latestDate.toISOString().split('T')[0]);
                    }
    
                    // Initial update
                    filterTrades();
    
                } catch (error) {
                    console.error('Error loading trade data:', error);
                    $('#trade-records').html(`
                        <tr>
                            <td colspan="9" class="p-4 text-center text-red-500">
                                ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: ${error.message}
                            </td>
                        </tr>
                    `);
                }
            }
    
            // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            loadAllTrades();
    
            // Event Bindings
            $('#applyFilter').click(filterTrades);
            $('input[name="chartType"]').change(filterTrades);
            $('#symbolFilter, #startDate, #endDate').change(function() {
                $('#applyFilter').click();
            });
        });
    </script>
</body>
</html>